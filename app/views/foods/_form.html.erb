<%= simple_form_for(food, html: { multipart: true }) do |f| %>
  <%= f.error_notification %>

  <div class="nf-form-body">
    <!-- Basic info -->
    <%= f.input :title,
                required: true,
                label: "Title",
                placeholder: "Lasagna, apple pie, veggie curry..." %>

    <%= f.input :description,
                as: :text,
                label: "Description",
                input_html: { rows: 3 },
                placeholder: "Short description and anything neighbours should know." %>

    <!-- Kind & quantity side by side -->
    <div class="nf-form-row">
      <%= f.input :kind_of_food,
                  as: :select,
                  collection: Food.kind_of_foods.keys.map { |k| [k.humanize, k] },
                  prompt: "Select kind of food",
                  label: "Kind of food",
                  required: true %>

      <%= f.input :quantity,
                  prompt: "Portions / Items",
                  label: "Quantity",
                  required: true %>
    </div>

  <!-- COLLECTION WINDOW -->
  <div class="nf-datetime-row-wrapper">

    <!-- COLLECTION START -->
    <div class="nf-datetime-wrapper" data-controller="nfdatetime" data-nfdatetime-type="start">
      <label class="nf-label"><strong>Collection start</strong></label>

      <div class="nf-datetime-row">

        <!-- DATE SELECT -->
        <div class="nf-collect-select nf-collect-select--date" data-nfdatetime-target="dateSelect">
          <button type="button" class="nf-collect-trigger" data-action="click->nfdatetime#toggleDate">
            <span data-nfdatetime-target="dateLabel">Select date</span>
          </button>

          <ul class="nf-collect-options" data-nfdatetime-target="dateOptions">
            <% 14.times do |i| %>
              <% date = Date.today + i.days %>
              <li data-value="<%= date.strftime('%Y-%m-%d') %>"
                  data-text="<%= date.strftime('%d %b %Y') %>"
                  data-action="click->nfdatetime#chooseDate">
                <%= date.strftime('%d %b %Y') %>
              </li>
            <% end %>
          </ul>
        </div>

        <!-- TIME ROW (hour + minute) -->
        <div class="nf-datetime-time-row">

          <!-- HOUR SELECT -->
          <div class="nf-collect-select nf-collect-select--hour" data-nfdatetime-target="hourSelect">
            <button type="button" class="nf-collect-trigger" data-action="click->nfdatetime#toggleHour">
              <span data-nfdatetime-target="hourLabel">--</span>
            </button>
            <ul class="nf-collect-options" data-nfdatetime-target="hourOptions">
              <% (0..23).each do |h| %>
                <li data-value="<%= "%02d" % h %>" data-action="click->nfdatetime#chooseHour">
                  <%= "%02d" % h %>
                </li>
              <% end %>
            </ul>
          </div>

          <span class="nf-datetime-separator">:</span>

          <!-- MINUTE SELECT -->
          <div class="nf-collect-select nf-collect-select--minute" data-nfdatetime-target="minuteSelect">
            <button type="button" class="nf-collect-trigger" data-action="click->nfdatetime#toggleMinute">
              <span data-nfdatetime-target="minuteLabel">--</span>
            </button>
            <ul class="nf-collect-options" data-nfdatetime-target="minuteOptions">
              <% [0,5,10,15,20,25,30,35,40,45,50,55].each do |m| %>
                <li data-value="<%= "%02d" % m %>" data-action="click->nfdatetime#chooseMinute">
                  <%= "%02d" % m %>
                </li>
              <% end %>
            </ul>
          </div>

        </div> <!-- END TIME ROW -->

      </div>

      <%= f.hidden_field :start_time, data: { nfdatetime_target: "hiddenField" } %>
    </div>



    <!-- COLLECTION END -->
    <div class="nf-datetime-wrapper" data-controller="nfdatetime" data-nfdatetime-type="end">
      <label class="nf-label"><strong>Collection end</strong></label>

      <div class="nf-datetime-row">

        <!-- DATE LOCKED -->
        <div class="nf-collect-select nf-collect-select--date nf-collect-select--locked" data-nfdatetime-target="dateSelect">
          <button type="button" class="nf-collect-trigger" disabled>
            <span data-nfdatetime-target="dateLabel"> Date</span>
          </button>

          <ul class="nf-collect-options" data-nfdatetime-target="dateOptions"></ul>
        </div>

        <!-- TIME ROW -->
        <div class="nf-datetime-time-row">

          <!-- HOUR SELECT -->
          <div class="nf-collect-select nf-collect-select--hour" data-nfdatetime-target="hourSelect">
            <button type="button" class="nf-collect-trigger" data-action="click->nfdatetime#toggleHour">
              <span data-nfdatetime-target="hourLabel">--</span>
            </button>
            <ul class="nf-collect-options" data-nfdatetime-target="hourOptions">
              <% (0..23).each do |h| %>
                <li data-value="<%= "%02d" % h %>" data-action="click->nfdatetime#chooseHour">
                  <%= "%02d" % h %>
                </li>
              <% end %>
            </ul>
          </div>

          <span class="nf-datetime-separator">:</span>

          <!-- MINUTE SELECT -->
          <div class="nf-collect-select nf-collect-select--minute" data-nfdatetime-target="minuteSelect">
            <button type="button" class="nf-collect-trigger" data-action="click->nfdatetime#toggleMinute">
              <span data-nfdatetime-target="minuteLabel">--</span>
            </button>
            <ul class="nf-collect-options" data-nfdatetime-target="minuteOptions">
              <% [0,5,10,15,20,25,30,35,40,45,50,55].each do |m| %>
                <li data-value="<%= "%02d" % m %>" data-action="click->nfdatetime#chooseMinute">
                  <%= "%02d" % m %>
                </li>
              <% end %>
            </ul>
          </div>

        </div> <!-- END TIME ROW -->

      </div>

      <%= f.hidden_field :end_time, data: { nfdatetime_target: "hiddenField" } %>
    </div>

  </div>


    <!-- Cooking / expiry dates â€“ compact HTML5 date inputs -->
  <div class="date-wrapper">
    <div class="nf-form-row nf-cook-expire">
      <%= f.input :cooking_date,
                  as: :string,
                  label: "Cooking date",
                  input_html: { type: "date" } %>

      <%= f.input :expire_date,
                  as: :string,
                  label: "Expire date",
                  input_html: { type: "date" } %>
    </div>
  </div>

    <!-- Tags (via food_tags join) -->
    <fieldset class="nf-form-group">
      <legend>Tags</legend>
      <div class="nf-form-checkbox-list">
        <%= f.collection_check_boxes :tag_ids, Tag.all, :id, :name do |tag_builder| %>
          <label>
            <%= tag_builder.check_box %>
            <%= tag_builder.text %>
          </label>
        <% end %>
      </div>
    </fieldset>

    <!-- Photos -->
    <div class="nf-form-group">
      <%= f.input :photos,
                  as: :file,
                  label: "Photos",
                  input_html: { multiple: true } %>
    </div>
  </div>

  <div class="nf-form-actions">
    <%= f.button :submit, "Post Food", class: "nf-btn nf-btn--primary" %>
    <%= link_to "Cancel", foods_path, class: "nf-btn nf-btn--ghost" %>
  </div>
<% end %>
